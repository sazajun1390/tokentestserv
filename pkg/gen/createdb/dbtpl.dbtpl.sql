-- Generated by dbtpl for the public schema.

-- enum status_enum
CREATE TYPE status_enum AS ENUM (
  'active',
  'provisioning',
  'inactive',
  'deleted',
  'purged',
  'unspecified'
);

-- table bun_migration_locks
CREATE TABLE bun_migration_locks (
  id BIGSERIAL,
  table_name VARCHAR,
  PRIMARY KEY (id),
  UNIQUE (table_name)
);

-- table bun_migrations
CREATE TABLE bun_migrations (
  id BIGSERIAL,
  name VARCHAR,
  group_id BIGINT,
  migrated_at TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,
  PRIMARY KEY (id)
);

-- table users
CREATE TABLE users (
  id BIGSERIAL,
  created_at TIMESTAMPTZ NOT NULL,
  PRIMARY KEY (id)
);

-- table user_actives
CREATE TABLE user_actives (
  user_id BIGINT NOT NULL REFERENCES users (id),
  status STATUS_ENUM DEFAULT 'active' NOT NULL,
  created_at TIMESTAMPTZ NOT NULL,
  updated_at TIMESTAMPTZ NOT NULL,
  UNIQUE (user_id)
);

-- table user_profiles
CREATE TABLE user_profiles (
  user_id BIGINT NOT NULL REFERENCES users (id),
  user_multi_id VARCHAR NOT NULL,
  resource_id VARCHAR NOT NULL,
  email VARCHAR NOT NULL,
  password VARCHAR NOT NULL,
  tel VARCHAR,
  created_at TIMESTAMPTZ NOT NULL,
  updated_at TIMESTAMPTZ NOT NULL,
  deleted_at TIMESTAMPTZ,
  purged_expires_at TIMESTAMPTZ,
  UNIQUE (email),
  UNIQUE (resource_id),
  UNIQUE (user_id),
  UNIQUE (user_multi_id)
);
